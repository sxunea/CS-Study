# MVC 패턴 Model-View-Controller Pattern

## MVC 패턴이란?

모델(Model), 뷰(View), 컨트롤러(Controller)로 이루어진 디자인 패턴

![image](https://github.com/zeunxx/Inflearn-Spring-RoadMap/assets/81572478/9839c78b-5806-4f93-bb87-9ccb3d038e78)

애플리케이션의 구성 요소를 세가지 역할로 구분해 개발 프로세스에서 각각의 구성요소에만 집중해서 개발할 수 있다.

- 장점: 재사용성과 확장성 용이
- 단점: 애플리케이션이 복잡해질수록 모델과 뷰의 관계가 복잡해진다.


### 1️⃣ Model

애플리케이션의 데이터인 데이터베이스, 상수, 변수 등을 뜻한다.
또한 이런 데이터의 가공을 책임지는 컴포넡트를 말한다.

- 비즈니스 로직을 처리한 후 모델의 변경사항을 컨트롤러와 뷰에 전달한다.

- 뷰에서 데이터를 생성하거나 수정하면 컨트롤러를 통해 모델을 생성하거나 갱신한다.


**💡 모델의 규칙**

1. 사용자가 편집하길 원하는 모든 데이터를 가지고 있어야 한다.
2. 뷰나 컨트롤러에 대해 어떤 정보도 알지 말아야 한다.
3. 변경이 일어나면, 변경 통지에 대한 처리 방법을 구현해야 한다.



### 2️⃣ View

사용자 인터페이스 요소

즉, 모델을 기반으로 사용자가 볼 수 있는 화면

- MVC 패턴은 여러개의 뷰가 존재할 수 있으며, 모델에게 질의해 데이터를 전달받아 이를 화면에 표시해주는 역할을 한다.
- 변경이 일어나면 컨트롤러에 이를 전달해야 한다.


**💡 뷰의 규칙**

1. 모델이 가지고 있는 정보를 따로 저장하지 않아야 한다.
2. 모델이나 컨트롤러와 같이 다른 구성요소들을 몰라야 한다.
3. 변경이 일어나면, 변경 통지에 대한 처리 방법을 구현해야 한다.



### 3️⃣ Controller

하나 이상의 모델과 하나 이상의 뷰를 잇는 다리 역할을 하며 이벤트 등 메인 로직을 담당한다.

- 모델과 뷰의 생명주기를 관리한다.
- 모델이나 뷰의 변경 통지를 받으면, 이를 해석해 각각의 구성요소에 해당 내용에 대해 알려준다.


**💡 컨트롤러의 규칙**
1. 모델이나 뷰에 대해서 알고 있어야 합니다.
2. 모델이나 뷰의 변경을 모니터링 해야 합니다.


- 출처: https://junhyunny.github.io/information/design-pattern/mvc-pattern/



## 스프링에서의 MVC 패턴

MVC 패턴을 도입하며 UI 영역과 도메인(비즈니스 로직) 영역으로 구분되어 서로에게 영향을 최대한 주지 않으며 개발과 유지보수할 수 있게 되었다.

### 1️⃣ Model

Spring MVC 기반의 웹 애플리케이션이 클라이언트의 요청을 전달받으면 요청 사항을 처리하기 위한 작업을 한다. 

처리한 작업의 결과 데이터를 클라이언트에게 응답을 돌려주는데 

이때, **작업 처리 결과 데이터를 Model**이라 한다.


- 서비스 계층(Service layer) : 클라이언트의 요청 사항을 구체적으로 처리하는 영역
- 비즈니스 로직(Business Logic) : 요청사항을 처리하기 위해 JAVA 코드로 구현한 것

    ➡️ Spring에선 service 클래스



### 2️⃣ View 

Model을 이용해 웹 브라우저와 같은 애플리케이션 화면에 보이는 리소스를 제공하는 역할


Spring MVC에서 제공하는 다양한 View
- HTML 페이지 출력
- PDF, Excel 등의 문서 형태로 출력
- XML, JSON 등 특정 형식의 포맷으로 변환


### 3️⃣ Controller

클라이언트 측의 요청을 직접적으로 전달받는 엔드포인트로써, Model과 View의 중간에서 상호작용을 해주는 역할


클라이언트 측의 요청을 받아 비즈니스 로직을 거친 후, Model 데이터가 만들어지면 이 Model 데이터를 View로 전달하는 역할을 한다.


### Spring MVC의 구조

![image](https://github.com/zeunxx/Inflearn-Spring-RoadMap/assets/81572478/7bc3a75c-39cb-461b-98bb-04f6c71354c7)


✅ 요청 흐름
상황 : 클라이언트가 HTTP 요청을 하면 Dispatcher servlet에서 이를 받는다.
    - Dispatcher Servlet : HTTP 프로토콜로 들어오는 모든 요청을 가장 먼저 받아 적합한 컨트롤러에 위임해주는 프론트 컨트롤러(Front Controller)

1. 핸들러 조회: 핸들러 매핑을 통해 요청 url에 매핑된 핸들러(controller)를 조회한다
    ex) "localhost:8080/user/getUser"의 경우 "/user/getUser"를 가진 컨트롤러 클래스 조회

2. 핸들러 어댑터 조회: 핸들러를 실행할 수 있는 핸들러 어댑터를 조회한다.

3. 핸들러 어댑터 실행

4. 핸들러 실행: 핸들러 어댑터가 실제 핸들러 실행

5. ModelAndView 반환 : 핸들러 어댑터는 핸들러가 반환하는 정보(비즈니스 로직이 돌아간 결과 데이터 등)를 ModelAndView로 변환해서 반환한다.

6. ViewResolver 호출: 뷰 리졸버를 찾고 실행한다.

    - View Resolver : 스프링 백엔드에서 데이터를 처리하거나 가지고 왔다면, 이 데이터를 View의 영역으로 전달을 해야 한다. 이때 View를 어떤 것을 사용할지 결정한다.

7. View 반환 

8. View 렌더링

- 출처: 인프런 스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술 (김영한)