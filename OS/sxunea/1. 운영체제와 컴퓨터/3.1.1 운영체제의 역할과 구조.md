# 3.1.1 운영체제의 역할과 구조

[컴퓨터 시스템의 구성](#컴퓨터-시스템의-구성)

[컴퓨터 하드웨어의 구성](#컴퓨터-하드웨어의-구성)

- [프로세서 (CPU)](#프로세서-cpu)
    - [레지스터](#레지스터)
    - [연산장치 (ALU)](#연산장치-alu)
    - [제어장치 (CU)](#제어장치-cu)

- [메모리](#메모리)
    - [메모리 계층 구조](#메모리-계층-구조)
    - [레지스터](#레지스터)
    - [캐시](#캐시)
    - [메인 메모리](#메인-메모리)

- [보조 기억 장치](#보조-기억-장치)

- [시스템 버스](#시스템-버스)

- [주변 장치](#주변-장치)

  <br>


# 컴퓨터 시스템의 구성
![Untitled](https://github.com/sxunea/CS-Study/assets/81434152/1efa49e7-5cb2-48ea-bc28-d3d938de7c02)

유저 프로그램 - **GUI - 시스템 콜 - 커널 - 드라이버** - 하드웨어 로 이루어져 있다.

이때 볼드 처리 된 부분이 OS, 즉 운영체제에 해당하는 부분 

<br>


# 컴퓨터 하드웨어의 구성



컴퓨터 시스템은 크게 사용자, 하드웨어, 소프트웨어로 구성되는데, 이때 **운영체제는 이 하드웨어를 관리하고, 하드웨어와 소프트웨어, 사용자를 매개하는 프로그램**이다. 

하드웨어는 다음으로 구성되어 있고, **시스템 버스로 연결**되어 있다.
- **프로세서(CPU)**
- **메모리**
- **주변 장치(입출력 장치 등)**

<br>


![1Untitled](https://github.com/sxunea/CS-Study/assets/81434152/42b438a2-211e-40a8-bcc3-7f762a17e441)


<br>


## 프로세서 (CPU)


**프로세서는 하드웨어에 부착된 모든 장치의 동작을 제어하고 명령을 실행**한다. 이는 **레지스터, 연산장치(ALU), 제어 장치(CU)로 구성**되어있고, 내부 버스로 연결된다. 

![Un2titled](https://github.com/sxunea/CS-Study/assets/81434152/3ed3c911-869e-4271-8be5-519209290c43)



### 레지스터 

레지스터는 CPU안에 있는 매우 빠른 임시기억장치이다. CPU와 직접 연결되어있어 빠르고, 프로그램 속 명령어와 데이터는 실행 전후로 반드시 레지스터에 저장된다. 

<details>
    <summary>  레지스터의 종류는 CPU에 따라 상이하지만, 대표적으로 다음과 같은 것들이 있다.</summary> 
    
<br>

1. **프로그래밍 카운터(PC, Program Counter)**  
프로그램 카운터 또는 명령어 포인터(IP, Instruction Pointer)는 메모리에서 가져올 명령어의 주소, 즉 메모리에서 읽어들일 명령어의 주소를 저장한다.

2. **명령어 레지스터(IR, Instruction Register)**  
명령어 레지스터(IR)는 메모리에서 읽어들인 해석할 명령어를 저장하는 레지스터이다.

3. **메모리 주소 레지스터(MAR, Memory Address Register)**  
메모리 주소 레지스터(MAR)는 메모리의 주소를 저장하는 레지스터이다. CPU가 읽어들이고자 하는 주소 값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거치게 된다.

4. **메모리 버퍼 레지스터(MBR, Memory Buffer Register)**  
메모리 버퍼 레지스터(MBR) 또는 메모리 데이터 레지스터(MDR, Memory Data Register)는 메모리와 주고받은 데이터나 명령어를 저장하는 레지스터이다. CPU가 MAR을 거쳐 주소 버스로 값을 내보내면 데이터 버스로 데이터가 MBR을 거친다.

5. **범용 레지스터(general purpose register)**  
범용 레지스터는 이름 그대로 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터이다. 일반적으로 MAR은 메모리 주소값만, MBR은 데이터 버스로 주고받을 값만 저장하지만, 범용 레지스터는 데이터와 주소를 모두 저장할 수 있다.

6. **플래그 레지스터(flag register)**  
플래그 레지스터는 ALU 연산 결과에 따른 부가적인 정보인 플래그를 저장하는 레지스터이다.

7. **스택 포인터(stack pointer)**  
스택 포인터는 스택 주소 지정 방식을 사용할 때 사용하는 레지스터로, 스택에 마지막으로 저장한 값의 위치를 저장하는 레지스터이다.

8. **베이스 레지스터(base register)**  
베이스 레지스터란 베이스 레지스터 주소 지정 방식에서 사용하는 기준 주소를 저장하는 레지스터이다.

</details>


<br>

<br>


### 연산장치 (ALU)

ALU는 이름처럼 **산술연산이나 논리연산을 진행하는 디지털 회로**이다. 이는 **레지스터를 통해 피연산자를 받아들이고, CU(제어장치)로부터 수행할 연산을 알려주는 제어신호를 받아들여** 다양한 연산을 수행한다. 

연산 후에 ALU는 결과값을 바로 메모리에 저장시키지 않고 일시적으로 레지스터에 저장시킨 다음, 연산결과에 대한 추가적인 상태 정보인 플래그(flag)를 플래그 레지스터로 내보낸다. 


이때 플래그는 부호, 오버플래그 여부 등 연산 결과에 대한 추가 정보를 담고 있다. 

<br>

**레지스터가 피연산자를 제공하는 이유**

- CPU가 연산을 수행할 때, 메모리(RAM)에서 직접 데이터를 가져와 연산하는 것은 속도와 효율성 면에서 비효율적이기 때문에, **CPU는 연산에 필요한 데이터를 먼저 레지스터에 저장한 후 연산을 진행**한다.

- 예를 들어, 두 숫자를 더하는 연산을 수행하려면, 두 숫자(피연산자)를 레지스터에 먼저 저장한 후 ALU에서 이를 꺼내 연산을 수행한다. 이때 레지스터는 CPU 내부에 있어 ALU가 매우 빠르게 접근할 수 있어서 속도 면에서도 효율적이다. 


**CU가 제어신호를 제공하는 이유**

- 프로그램의 명령어가 실행될 때, **CU는 그 명령어가 어떤 연산을 수행해야 하는지 해석하고, 이에 맞는 제어신호를 ALU와 다른 장치들로 보낸다**.

- 예를 들어, 덧셈을 수행하라는 명령어가 들어오면, CU는 ALU에 덧셈을 수행하라는 신호를 보낸다.


<br>

<br>

<br>

### 제어장치 (CU)

**제어장치는 제어 신호(control signal)를 통해서 명령어를 해석, 조작을 지시하는 장치**이다. 제어 신호는 컴퓨터 부품을 관리하고 작동시키기 위한 일종의 전기 신호이다

- CPU가 메모리에 저장된 값을 읽고 싶을 땐 메모리를 향해 메모리 읽기라는 제어 신호를 보낸다.
- CPU가 메모리에 어떤 값을 저장하고 싶을 땐 메모리를 향해 메모리 쓰기라는 제어 신호를 보낸다.


<br>

<br>


**➡️ 하나의 연산을 위해 CPU 내 레지스터, ALU, CU가 어떻게 동작하는 지는 [이 링크](https://hongong.hanbit.co.kr/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%98-4%EA%B0%80%EC%A7%80-%ED%95%B5%EC%8B%AC-%EB%B6%80%ED%92%88cpu-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%B3%B4%EC%A1%B0%EA%B8%B0%EC%96%B5%EC%9E%A5/)를 참고하자 ! 이해가 쉬웠다**


<br>


## 메모리

메모리는 프로그램, 데이터 등을 저장하는 장치이다. 

**주 기억장치(메인 메모리)와 보조 기억 장치**로 나뉘며, 이때 메모리는 속도가 빠르면 비용이 비싸서 **메모리 계층구조를 활용해 이를 보완**한다. 이를 이용해 불필요한 프로그램과 데이터는 보조 기억 장치에 저장했다가 실행, 참조할 때만 메인 메모리로 옮긴다

## 메모리 계층 구조

![Un3titled](https://github.com/sxunea/CS-Study/assets/81434152/5f9bb189-8170-40b6-9a4c-ee6594babdc9)

### 레지스터

- 프로세서 **내부에** 있으며, 프로세서가 사용할 데이터를 보관하는 **가장 빠른 메모리**이다. 

### 캐시

- 프로세서 내부나 외부에 있으며, **프로세서는 속도가 빠르고 메인 메모리는 느려서 이 속도 차이를 보완하기 위해 만든 고속 버퍼**이다. 

- 캐시는 받은 **데이터의 주소 영역을 한 번 읽어 들일 수 있는 크기로 나눈 후** 각 블럭에 **번호를 부여하고 이를 태그로 저장**한다. 따라서 프로세서가 메인 메모리에 접근하기 전에 **원하는 주소의 자료가 있는지 캐시에서 먼저 확인**하는 식으로 속도를 보완한다. 이때 캐시의 성능을 높이기 위해 블럭의 크기를 무작정 높이면 히트율은 늘어날 수 있지만, 전송 부담과 데이터 교체 작업이 자주 일어나므로 부하가 커서 어렵다

### 메인 메모리

- 프로세서 **외부에** 있으며, **프로세서에서 즉시 수행할 프로그램과 데이터를 저장하거나 작업한 결과를 저장하는 역할**을 한다. 

- 메모리는 셀로 구성되어 있는데, 비트라면 주소 범위는 2^n-1로 이루어져 있다. 메인 메모리는 프로세서와 보조 기억 장치 사이에 있으며, 이 사이에서 발생하는 디스크 i/o 병목 현상 해결 역할 또한 한다. 

### 보조 기억 장치

- 주변 장치 중 프로그램과 데이터를 저장하는 하드웨어로, 자기 디스크, 광 디스크, 자기 테이프 등이 해당한다.

<br>

## 시스템 버스

시스템 버스는 하드웨어를 물리적으로 연결해 서로 데이터를 주고 받을 수 있게 하는 통로로, 다양한 신호를 전달한다. 데이터 버스, 제어 버스, 주소 버스라는 하위 버스로 이루어져 있다. 

**제어 버스 (Control Bus)**
- 제어 버스는 CPU가 시스템 내의 각종 요소들의 동작을 제어하는데 필요한 신호들을 전달하는 통로이다
- 제어 선의 개수는 CPU 또는 시스템 구성에 따라 다르다
- 가장 기본적인 제어 신호들로는 기억장치나 I/O에서의 읽기/쓰기 신호가 있다
- 읽기/쓰기 동작을 모두 수행하기 때문에 양방향 버스이다
 
**주소 버스 (Address Bus)**
- 주소 버스는 다른 장치로 주소 정보(기억장치 주소, I/O 장치 포트 번호)를 전달하는 통로이다
- 주소 선의 개수 == 주소 버스의 폭(Width) == 최대 기억장치 용량 ( 2^주소 버스의 폭 )
- 주소를 전달만 하기 때문에 단방향 버스이다
 
**데이터 버스 (Data Bus)**
- 데이터 버스는 CPU와 다른 장치 사이에서 실질적인 데이터를 전달하는 통로이다
- 데이터를 주고 받아야 하기 때문에 양방향 버스이다
- 데이터 버스의 폭(Width)가 한 번에 전송될 수 있는 데이터의 크기(비트 수)를 결정한다
    - Word 크기, 레지스터 크기와 같다
    - 만약 데이터 버스 크기가 32bit 라면, 데이터를 한 번에 32bit씩 읽을 수 있다


<br>

## 주변 장치



- 입력 장치
- 출력 장치
- 저장 장치
