# 메모리 관리

## 가상 메모리

메모리 관리 기법 중 하나로, 메모리가 실제 메모리보다 많아 보이게 하는 기술.

어떤 프로세스가 실행될 때 메모리에 해당 프로세스 전체가 올라가지 않더라도 실행이 가능하게 한다.
- 애플리케이션이 실행될때, 실행에 필요한 일부분만 메모리에 올라가며 애플리케이션의 나머지는 디스크에 남게 됨
- 빠르고 작은 기억장치(RAM)을 크고 느린 기억장치(디스크)와 병합해, 하나의 크고 빠른 기억장치(가상메모리)처럼 동작하게 함

![image](https://github.com/zeunxx/algorithm/assets/81572478/4f77a573-33bf-461f-9811-fb61d29e34f1)


<BR>

- 가상 주소(logical address): 가상적으로 주어진 주소
- 실제 주소(physical address): 실제 메모리 상에 있는 주소
- **MMU(Memory Management Unit) 메모리 관리 장치** : 가상주소를 물리주소로 변환하고, 메모리를 보호하는 기능을 수행함
    - MMY를 사용하면, CPU가 각 메모리에 접근하기 전에 메모리 주소 번역 작업이 수행 됨
    - BUT, 메모리를 일일히 가상 주소에서 물리 주소로 번역하면 작업 부하가 높아, MMU는 RAM을 여러부분(**페이지 page**)로 나누어 각 페이지를 하나의 독립된 항목으로 처리함
    - 페이지 및 주소 번역 정보를 기억하는 작업이 중요함
    - 가상 메모리는 가상 주소와 실제 주소가 매핑되어 있고 프로세스의 주소 정보가 들어있는 **'페이지 테이블'**로 관리 됨

<br><Br>

## 요구 페이징 demand paging

CPU가 요청할때 프로세스의 데이터를 메모리에 올리는 것

= 처음부터 모든 데이터를 메모리에 적재하지 않음


<BR><br>

## TLB (Translation Lookaside Buffer, 페이지 정보 캐쉬)

가상 메모리 주소를 물리적 주소로 변환하는 속도를 높이기 위해 사용하는 캐시 

- 최근에 일어난 가상메모리와 물리주소의 변환 테이블을 저장
- CPU가 가상 주소를 가지고 메모리에 접근하려 할때 우선 TLB에 접근해 가상 주소에 해당되는 물리 주소를 찾고, TLB에 매핑이 존재하지 않으면 MMU가 페이지 테이블에 해당되는 물리주소로 변환 후 메모리에 접근


<BR><BR>

## 페이지 폴트 page faults

어떤 페이지에 접근하려고 할때 해당 페이지가 실제 물리 메모리에 부재할때 뜨는 인터럽트.
- 어떤 프로그램이 자신의 주소공간(가상 메모리 공간)에는 존재하지만, 시스템의 RAM에는 현재 존재하지 않는 데이터/코드에 접근을 시도할 경우 발생

페이지 폴트가 발생하면 OS가 이를 해결한 뒤 다시 동일한 명령 수행
- 페이지 폴트 발생시 운영체제는 그 데이터를 메모리로 가져와서, 마치 페이지 폴트가 전혀 발생하지 않은 것처럼 작동하게 함
- 페이지 폴트가 자주 일어날 수록 운영체제의 성능이 저하되므로 페이지 폴트가 일어나지 않게 하는 것이 중요 
    ➡️ 페이지 폴트를 최소화하기 위해 **페이지 교체 정책** 사용


<bR>

- 페이지 교체 정책
    메모리가 꽉 차있을때 기존 페이지 중 하나늘 물리 메모리에서 저장 매체로 내리고, 새로운 패이지를 방금 비워진 해당 물리 공간에 올림. 이때 기존 페이지 중 어떤 것을 내리면 좋을지에 대한 알고리즘을 짠 것이 **페이지 교체 알고리즘**



### 스레싱

메모리의 페이지 폴트율이 높은 것을 의미하고, 컴퓨터의 심각한 성능 저하 유래

- 스레싱은 메모리에 너무 많은 프로세스가 동시에 올라가면 스와핑이 많이 일어나서 발생
    - 스와핑: 메모리에서 당장 사용하지 않는 영역을 하드디스크로 옮기고 하드디스크의 일부분을 메모리처럼 불러와 쓰는 것
- 페이지 폴트가 일어나면 CPU 이용률이 낮아짐 ➡️ CPU 이용률이 낮으면 가용성을 높이기 위해 더 많은 프로세스를 메모리에 올림 ➡️ 악순환


- 작업 세트 : 프로세스의 과거 사용 이력인 지역성을 통해 결정된 페이지 집합을 만들어 미리 메모리에 로드하는 것. 미리 메모리에 로드하면 탐색에 드는 비용을 줄이고 스와핑 또한 줄음
- PFF(Page Fault Frequency) : 페이지 폴트 빈도를 조절하는 방법으로 상한선과 하한선을 만드는 것. 상한선에 도달하면 프레임을 늘리고, 하한선에 도달하면 프레임을 줄임
    - ...?????

<BR><BR>

## 메모리 할당

## 연속 할당

## 불연속 할당


<BR><BR>

## 페이지 교체 알고리즘